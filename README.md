# Тестовое задание RestAPI

## Установка проекта

### Зависимости:
* `PHP >= 8.1`
* `MySQL >= 5.6`
* `phpunit`

1. Склонируйте git-репозиторий:
```
git clone git@github.com:BrunoCry/test-rest.dev.git <your_folder>
```

2. Установите необходимые зависимости:
```
composer install
```

3. Установите соединение с базой данных MySQL, изменив следующие параметры в конфигурационном файле `.env`:
```
DB_HOST=     # IP адрес сервера, где расположена база даннных (по умолчанию localhost)
DB_PORT=     # Порт подключения к базе даных (по умолчанию localhost)
DB_DATABASE= # Название базы данных
DB_USERNAME= # Пользователь для установки соединения
DB_PASSWORD= # Пароль пользователя
```

4. Выполните миграции:
```
php artisan migrate
```

5. Для локальной проверки можно запустить тестовый сервер:
```
cd <путь_к_корневой_директории_проекта>
php -S localhost:8080 -t public
```
**Для использования проекта может потребоваться дальнейшая настройка nginx/apache!**

### Установка сборщика ошибок Sentry
1. Зарегистрируйте аккаунт на платформе [Sentry](https://sentry.io/);
2. Выберите в качестве шаблона проекта **Laravel**;
3. Установите параметры соединения Sentry в `.env`:
```
SENTRY_LARAVEL_DSN=
SENTRY_TRACES_SAMPLE_RATE=
SENTRY_PROFILES_SAMPLE_RATE=
```
4. Создайте конфигурационый файл Sentry:
```
cp vendor/sentry/sentry-laravel/config/sentry.php config/sentry.php
```
5. Для проверки соединения выполните команду `php artisan sentry:test`

При правильной настройке должно сгенерироваться необработанное исключение, которое будет отправлено на сервер.

### Тестирование
API данного проекта покрыто unit-тестами для выявления потенциальных ошибок в работе.
Тестирование проекта:
```
phpunit
```

## Использование API
| Метод    | URI               | Описание                                 | Параметры                                                                                                                         |
|----------|-------------------|------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| `GET`    | `/api/loans`      | Получение всех существующих займов.      | -                                                                                                                                 |
| `GET `   | `/api/loans/{id}` | Получение определенного займа по его ID  | **id** - номер займа                                                                                                              |
| `POST`   | `/api/loans`      | Создание нового займа                    | **name** - название займа;<br> **summ** - сумма займа;<br> **client_id** - ID клиента                                             |
| `PUT`    | `/api/loans/{id}` | Обновление информации о займе            | **id** - номер займа;<br> (opt) **name** - название займа;<br> (opt) **summ** - сумма займа;<br> (opt) **client_id** - ID клиента |
| `DELETE` | `/api/loans/{id}` | Удаление займа                           | **id** - номер займа                                                                                                              |

